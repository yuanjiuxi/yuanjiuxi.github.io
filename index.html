<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Commander Yuan | PhD Candidate</title>
    <style>
        :root {
            --primary: #8B4513;
            --bg: #fdfcf8;
            --text: #2c3e50;
            --accent: #c0392b; /* ÊÑ§ÊÄíÁ∫¢ */
        }

        body {
            margin: 0;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            overflow-x: hidden;
            touch-action: pan-y;
        }

        /* ÂØºËà™Ê†è */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            background: rgba(255, 255, 255, 0.95);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }
        .logo { font-weight: bold; font-size: 1.5rem; color: var(--primary); }
        .nav-links a { margin-left: 20px; text-decoration: none; color: var(--text); font-weight: 500; transition: 0.3s; }

        /* Header / Á≤íÂ≠êÂå∫Âüü */
        header {
            min-height: 85vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }

        h1 { font-size: 3rem; margin: 15px 0; color: var(--primary); }
        p.subtitle { font-size: 1.1rem; color: #555; margin-bottom: 30px; font-weight: 300; }
        
        /* Á≤íÂ≠êÁîªÂ∏É */
        #particle-wrapper {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto 20px;
        }
        #particle-canvas {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 15px 35px rgba(139, 69, 19, 0.15);
            background: #f0f0f0; 
        }
        
        /* Á§æ‰∫§ÊåâÈíÆ */
        .social-links { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
        .social-btn {
            background: #fff;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 8px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .social-btn:hover { background: var(--primary); color: #fff; transform: translateY(-2px); }

        /* ÂØºÂ∏àÈÉ®ÂàÜ */
        section { padding: 60px 8%; }
        .advisors {
            text-align: center;
            background: #fff;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.03);
        }
        .advisor-name { font-size: 1.1rem; margin: 10px; display: inline-block; font-weight: 500; }
        .advisor-name a { color: var(--primary); text-decoration: none; border-bottom: 1px dashed var(--primary); }

        /* ËßÜÈ¢ëÂå∫Âüü */
        #video-section { background: #f9f9f9; text-align: center; }
        video { width: 90%; max-width: 700px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }

        /* --- ÊÑ§ÊÄíÁöÑÂè∏‰ª§ Ê∏∏ÊàèÂå∫Âüü --- */
        #game-section {
            background: linear-gradient(135deg, #8e44ad, #3498db); /* Á¥´Ë∞ÉËÉåÊôØÔºåÂ∏¶ÁÇπÁ•ûÁßòÊÑü */
            color: #fff;
            text-align: center;
            padding-bottom: 60px;
            position: relative;
            user-select: none;
        }
        #game-title {
            font-family: 'Arial Black', sans-serif;
            font-size: 2.5rem;
            text-shadow: 3px 3px 0px #000;
            margin-bottom: 5px;
            color: #f1c40f;
        }
        #game-canvas {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            border: 4px solid rgba(255,255,255,0.3);
            display: block;
            margin: 20px auto;
            cursor: grab;
            touch-action: none; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        #game-canvas:active { cursor: grabbing; }
        
        .level-badge {
            background: #e74c3c;
            padding: 5px 20px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
            box-shadow: 0 5px 0 #c0392b;
            transform: translateY(0);
            transition: transform 0.1s;
        }

        /* ÁîªÂªä */
        .gallery-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        .locked-photo {
            position: relative;
            height: 350px;
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .locked-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: top center; 
            filter: blur(30px) grayscale(100%);
            transition: all 1s ease;
            opacity: 0.4;
        }
        .locked-photo.unlocked img {
            filter: blur(0) grayscale(0);
            opacity: 1;
        }
        .lock-icon {
            position: absolute;
            z-index: 10;
            font-size: 1.5rem;
            color: #333;
            background: rgba(255,255,255,0.9);
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: bold;
        }
        .locked-photo.unlocked .lock-icon { display: none; }

        /* ÂºπÁ™ó */
        .modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        .modal.active { opacity: 1; pointer-events: all; }
        .modal-content {
            background: #fff;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            width: 300px;
            transform: scale(0.8);
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal.active .modal-content { transform: scale(1); }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            #particle-canvas, #particle-wrapper { width: 240px; height: 240px; }
            .nav-links { display: none; } 
            section { padding: 40px 5%; }
            #game-canvas { width: 340px; height: 450px; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="logo">Commander Yuan</div>
        <div class="nav-links">
            <a href="#about">About</a>
            <a href="#video-section">Video</a>
            <a href="#game-section">Angry Commander</a>
        </div>
    </nav>

    <header id="about">
        <div id="particle-wrapper">
            <canvas id="particle-canvas"></canvas>
        </div>
        
        <h1>Âéü‰πÖËåú (Jiuxi Yuan)</h1>
        <p class="subtitle">
            Exploring the Micro-World of Irradiation-Resistant Materials
        </p>
        
        <div class="social-links">
            <a href="https://scholar.google.com/citations?user=5wDcIWYAAAAJ&hl=zh-CN&oi=ao" target="_blank" class="social-btn">Google Scholar</a>
            <a href="mailto:678ypw@gmail.com" class="social-btn">Email</a>
            <button class="social-btn" onclick="showModal('WeChat', 'Tahiti-sunlight')">WeChat</button>
            <button class="social-btn" onclick="showModal('Xiaohongshu', '354980229')">Â∞èÁ∫¢‰π¶</button>
        </div>
    </header>

    <section>
        <div class="advisors">
            <h2>Academic Advisors</h2>
            <div class="advisor-name">Prof. <a href="https://scholar.google.com/citations?hl=zh-CN&user=PT6XB5UAAAAJ" target="_blank">Ke Jin</a></div>
            <div class="advisor-name">Prof. Xun Guo</div>
            <div style="margin-top:15px; font-size: 0.95rem; color: #666;">
                Collaborator: <a href="https://scholar.google.com/citations?hl=zh-CN&user=cUB5XN8AAAAJ" target="_blank" style="color:#666; text-decoration:underline;">Peiwen Yuan</a>
            </div>
        </div>
    </section>

    <section id="video-section">
        <h2 style="margin-bottom:20px; color:var(--text)">Basketball Moments</h2>
        <video controls playsinline>
            <source src="./video.mp4" type="video/mp4">
            Your browser does not support html5 video.
        </video>
    </section>

    <section id="game-section">
        <div id="game-title">ANGRY COMMANDER</div>
        <p style="opacity: 0.9; margin-bottom: 20px;">
            Drag left to launch the Commander! (ÂêëÂêéÊãñÊãΩÔºåÂèëÂ∞ÑÂè∏‰ª§ÔºÅ)
        </p>
        <div class="level-badge" id="level-display">Level 1: First Strike</div>
        
        <!-- Ê∏∏ÊàèÁîªÂ∏É -->
        <canvas id="game-canvas" width="600" height="400"></canvas>
        
        <div class="gallery-container" id="gallery-container">
            <div class="locked-photo" id="lp1">
                <span class="lock-icon">üîí Mission 1 Reward</span>
                <img src="./img1.jpg" alt="Photo 1">
            </div>
            <div class="locked-photo" id="lp2">
                <span class="lock-icon">üîí Mission 2 Reward</span>
                <img src="./img2.jpg" alt="Photo 2">
            </div>
            <div class="locked-photo" id="lp3">
                <span class="lock-icon">üîí Mission 3 Reward</span>
                <img src="./img3.jpg" alt="Photo 3">
            </div>
        </div>
    </section>

    <div id="custom-modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title" style="color:var(--primary); margin-top:0;">Title</h3>
            <p style="color:#333;">Scan or Search ID:</p>
            <div style="background:#f1f2f6; padding:10px; font-weight:bold; color:var(--primary); margin:10px 0; user-select:all;" id="modal-text">ID</div>
            <button class="social-btn" onclick="closeModal()" style="background:var(--primary); color:#fff; border:none;">Close</button>
        </div>
    </div>

    <script>
        // --- 1. ÈÄöÁî®Â∑•ÂÖ∑ ---
        const modal = document.getElementById('custom-modal');
        function showModal(title, text) {
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-text').innerText = text;
            modal.classList.add('active');
        }
        function closeModal() { modal.classList.remove('active'); }
        modal.addEventListener('click', (e) => { if(e.target === modal) closeModal(); });

        // --- 2. Á≤íÂ≠êÂ§¥ÂÉè (È´òÊ∏ÖÁâà) ---
        const pCanvas = document.getElementById('particle-canvas');
        const pCtx = pCanvas.getContext('2d');
        const displaySize = 300;
        pCanvas.width = displaySize * 2; 
        pCanvas.height = displaySize * 2;
        pCtx.scale(2, 2); 

        let particles = [];
        const mouse = { x: null, y: null, radius: 60 };

        function getMousePos(evt) {
            const rect = pCanvas.getBoundingClientRect();
            return {
                x: (evt.clientX - rect.left) * (300 / rect.width),
                y: (evt.clientY - rect.top) * (300 / rect.height)
            };
        }
        pCanvas.addEventListener('mousemove', e => { const p = getMousePos(e); mouse.x = p.x; mouse.y = p.y; });
        pCanvas.addEventListener('touchmove', e => { const p = getMousePos(e.touches[0]); mouse.x = p.x; mouse.y = p.y; }, {passive: true});
        ['mouseleave', 'touchend'].forEach(evt => pCanvas.addEventListener(evt, () => { mouse.x = null; mouse.y = null; }));

        class Particle {
            constructor(x, y, color) {
                this.x = x; this.y = y; this.originX = x; this.originY = y;
                this.color = color; this.size = 2.2;
                this.vx = 0; this.vy = 0; this.friction = 0.85; this.ease = 0.15;
            }
            draw() { pCtx.fillStyle = this.color; pCtx.fillRect(this.x, this.y, this.size, this.size); }
            update() {
                if (mouse.x != null) {
                    const dx = mouse.x - this.x; const dy = mouse.y - this.y;
                    const dist = Math.sqrt(dx*dx + dy*dy);
                    if (dist < mouse.radius) {
                        const force = (mouse.radius - dist) / mouse.radius;
                        const angle = Math.atan2(dy, dx);
                        const push = force * 40;
                        this.vx -= Math.cos(angle) * push; this.vy -= Math.sin(angle) * push;
                    }
                }
                this.vx *= this.friction; this.vy *= this.friction;
                this.x += this.vx + (this.originX - this.x) * this.ease;
                this.y += this.vy + (this.originY - this.y) * this.ease;
            }
        }

        function initParticles() {
            const img = new Image();
            img.src = 'avatar.jpg';
            img.onload = () => {
                const buffer = document.createElement('canvas');
                buffer.width = 300; buffer.height = 300;
                const bCtx = buffer.getContext('2d');
                bCtx.drawImage(img, 0, 0, 300, 300);
                const data = bCtx.getImageData(0, 0, 300, 300).data;
                particles = [];
                for (let y = 0; y < 300; y += 2) {
                    for (let x = 0; x < 300; x += 2) {
                        const i = (y * 300 + x) * 4;
                        if (data[i + 3] > 128) {
                            particles.push(new Particle(x, y, `rgb(${data[i]}, ${data[i+1]}, ${data[i+2]})`));
                        }
                    }
                }
                animateParticles();
            };
            img.onerror = () => {
                pCtx.fillStyle = '#8B4513'; pCtx.font = 'bold 100px Arial';
                pCtx.fillText('Commander', 10, 150);
            }
        }
        function animateParticles() {
            pCtx.clearRect(0, 0, 300, 300);
            for (let p of particles) { p.update(); p.draw(); }
            requestAnimationFrame(animateParticles);
        }
        initParticles();

        // --- 3. ÊÑ§ÊÄíÁöÑÂè∏‰ª§ (Angry Commander Game) ---
        const gCanvas = document.getElementById('game-canvas');
        const gCtx = gCanvas.getContext('2d');
        
        // Ê∏∏ÊàèËµÑÊ∫ê
        const commanderImg = new Image();
        commanderImg.src = 'commander.png'; // ‰Ω†ÁöÑÂ§ßÂ§¥ÁÖß

        // Áâ©ÁêÜÂèÇÊï∞
        let level = 1;
        const GROUND_Y = 350;
        const SLING_X = 120;
        const SLING_Y = 280;
        
        // ÂºπÂºì‰∏éÁÇÆÂºπÁä∂ÊÄÅ
        let ball = { x: SLING_X, y: SLING_Y, r: 25, vx: 0, vy: 0, state: 'idle', rotation: 0 }; 
        // state: 'idle' (on sling), 'dragging', 'flying', 'hit'
        
        let dragPos = { x: SLING_X, y: SLING_Y };
        
        // ÁõÆÊ†á (Target Boxes)
        let targets = [];

        function initLevel() {
            ball.state = 'idle';
            ball.x = SLING_X; ball.y = SLING_Y;
            ball.vx = 0; ball.vy = 0;
            ball.rotation = 0;
            
            targets = [];
            // ÁîüÊàêÂÖ≥Âç°ÁõÆÊ†á
            if(level === 1) {
                // ÈùôÊ≠¢ÁöÑ‰∏â‰∏™ÁÆ±Â≠ê
                targets.push({ x: 450, y: GROUND_Y - 40, w: 40, h: 40, active: true });
                targets.push({ x: 450, y: GROUND_Y - 80, w: 40, h: 40, active: true });
                targets.push({ x: 450, y: GROUND_Y - 120, w: 40, h: 40, active: true });
            } else if (level === 2) {
                // ËøúÂ§ÑÁöÑÁÆ±Â≠ê + ÁßªÂä®ÈöúÁ¢ç
                targets.push({ x: 500, y: GROUND_Y - 40, w: 40, h: 40, active: true });
                targets.push({ x: 500, y: GROUND_Y - 80, w: 40, h: 40, active: true });
                // ËøôÈáåÁöÑÈÄªËæëÂú®updateÈáåÂ§ÑÁêÜÁßªÂä®
            } else {
                // Ë∫≤Âú®Â¢ôÂêéÈù¢
                targets.push({ x: 520, y: GROUND_Y - 40, w: 30, h: 30, active: true });
                targets.push({ x: 300, y: GROUND_Y - 100, w: 20, h: 100, active: true, type: 'wall' }); // Â¢ôÂ£Å
            }
            document.getElementById('level-display').innerText = `Level ${level}: ${getLevelName()}`;
        }

        function getLevelName() {
            if(level==1) return "First Strike";
            if(level==2) return "Long Shot";
            return "The Bunker";
        }

        // ËæìÂÖ•Â§ÑÁêÜ
        function getGameInput(e) {
            const rect = gCanvas.getBoundingClientRect();
            // ÈÄÇÈÖç Canvas Áº©Êîæ (CSS width vs Attribute width)
            const scaleX = gCanvas.width / rect.width;
            const scaleY = gCanvas.height / rect.height;
            const cx = e.touches ? e.touches[0].clientX : e.clientX;
            const cy = e.touches ? e.touches[0].clientY : e.clientY;
            return { x: (cx - rect.left) * scaleX, y: (cy - rect.top) * scaleY };
        }

        gCanvas.addEventListener('mousedown', startDrag);
        gCanvas.addEventListener('touchstart', startDrag, {passive: false});
        window.addEventListener('mousemove', moveDrag);
        window.addEventListener('touchmove', moveDrag, {passive: false});
        window.addEventListener('mouseup', endDrag);
        window.addEventListener('touchend', endDrag);

        function startDrag(e) {
            if(ball.state !== 'idle') return;
            if(e.cancelable) e.preventDefault();
            const pos = getGameInput(e);
            if(Math.hypot(pos.x - SLING_X, pos.y - SLING_Y) < 80) {
                ball.state = 'dragging';
                dragPos = pos;
            }
        }

        function moveDrag(e) {
            if(ball.state === 'dragging') {
                if(e.cancelable) e.preventDefault();
                let pos = getGameInput(e);
                // ÈôêÂà∂ÊãñÊãΩÂçäÂæÑ
                let dx = pos.x - SLING_X;
                let dy = pos.y - SLING_Y;
                let dist = Math.sqrt(dx*dx + dy*dy);
                let maxDist = 100;
                if(dist > maxDist) {
                    let ratio = maxDist / dist;
                    pos.x = SLING_X + dx * ratio;
                    pos.y = SLING_Y + dy * ratio;
                }
                dragPos = pos;
                ball.x = pos.x; 
                ball.y = pos.y;
            }
        }

        function endDrag(e) {
            if(ball.state === 'dragging') {
                ball.state = 'flying';
                // ÂèëÂ∞ÑÔºÅÂèçÂêëÂêëÈáè
                let dx = SLING_X - ball.x;
                let dy = SLING_Y - ball.y;
                ball.vx = dx * 0.18; // ÂäõÂ∫¶Á≥ªÊï∞
                ball.vy = dy * 0.18;
            }
        }

        function updateGame() {
            gCtx.clearRect(0, 0, gCanvas.width, gCanvas.height);

            // 1. ÁªòÂà∂ËÉåÊôØÂíåÂú∞Èù¢
            gCtx.fillStyle = '#ecf0f1'; // ‰∫ëÊúµËâ≤Âú∞Èù¢
            gCtx.fillRect(0, GROUND_Y, gCanvas.width, gCanvas.height - GROUND_Y);
            
            // 2. Áâ©ÁêÜÈÄªËæë
            if (ball.state === 'flying') {
                ball.vy += 0.4; // ÈáçÂäõ
                ball.x += ball.vx;
                ball.y += ball.vy;
                ball.rotation += 0.15; // ÊóãËΩ¨Âè∏‰ª§Â§¥

                // ËæπÁïå/Âú∞Èù¢Âà§ÂÆö
                if (ball.y + ball.r > GROUND_Y) {
                    ball.y = GROUND_Y - ball.r;
                    ball.vy *= -0.5; // Âú∞Èù¢Êë©Êì¶ÂèçÂºπ
                    ball.vx *= 0.6;
                    if(Math.abs(ball.vx) < 0.5 && Math.abs(ball.vy) < 0.5) {
                        setTimeout(initLevel, 1000); // ÂÅú‰∏ãÂêéÈáçÁΩÆ
                        ball.state = 'stopped';
                    }
                }
                if (ball.x > gCanvas.width) setTimeout(initLevel, 500);

                // Á¢∞ÊíûÊ£ÄÊµã (‰∏é Targets)
                let activeCount = 0;
                for(let t of targets) {
                    if(!t.active) continue;
                    activeCount++;
                    
                    // ÁÆÄÂçïÁöÑ AABB Á¢∞Êíû
                    if(ball.x + ball.r > t.x && ball.x - ball.r < t.x + t.w &&
                       ball.y + ball.r > t.y && ball.y - ball.r < t.y + t.h) {
                        
                        // ÊíûÂà∞‰∫Ü
                        if(t.type === 'wall') {
                             ball.vx *= -0.8; // ÊíûÂ¢ôÂèçÂºπ
                        } else {
                            // ÊíûÂà∞ÁõÆÊ†á
                            t.active = false; // Ê∂àÈô§ÁõÆÊ†á
                            ball.vy *= 0.8; 
                            // ‰∫ßÁîüÁàÜÁÇ∏ÊïàÊûú(ÁÆÄÂåñÔºöÁîª‰∏™Âúà)
                            gCtx.beginPath();
                            gCtx.fillStyle = '#f1c40f';
                            gCtx.arc(t.x + t.w/2, t.y + t.h/2, 30, 0, Math.PI*2);
                            gCtx.fill();
                        }
                    }
                }

                if(activeCount === 0 && targets.length > 0 && ball.state === 'flying') {
                    // Ëµ¢‰∫ÜÔºÅ
                    ball.state = 'win';
                    winLevel();
                }
            }

            // 3. ÁªòÂà∂ÂºπÂºìÂêéÈÉ® (Sling Back)
            gCtx.beginPath();
            gCtx.lineWidth = 6;
            gCtx.strokeStyle = '#3e2723';
            gCtx.moveTo(SLING_X - 15, SLING_Y);
            if(ball.state === 'dragging') {
                gCtx.lineTo(ball.x, ball.y + 10);
            } else {
                gCtx.lineTo(SLING_X, SLING_Y);
            }
            gCtx.stroke();

            // 4. ÁªòÂà∂ÁõÆÊ†á (Targets)
            for(let t of targets) {
                if(!t.active) continue;
                if(t.type === 'wall') {
                    gCtx.fillStyle = '#7f8c8d';
                    gCtx.fillRect(t.x, t.y, t.w, t.h);
                } else {
                    gCtx.fillStyle = '#e74c3c'; // Á∫¢Ëâ≤ÁõÆÊ†áÁÆ±Â≠ê
                    gCtx.fillRect(t.x, t.y, t.w, t.h);
                    // ÁÆ±Â≠êÁ∫πÁêÜ
                    gCtx.strokeStyle = '#fff';
                    gCtx.lineWidth = 2;
                    gCtx.strokeRect(t.x, t.y, t.w, t.h);
                    gCtx.beginPath(); gCtx.moveTo(t.x, t.y); gCtx.lineTo(t.x+t.w, t.y+t.h); gCtx.stroke();
                    gCtx.beginPath(); gCtx.moveTo(t.x+t.w, t.y); gCtx.lineTo(t.x, t.y+t.h); gCtx.stroke();
                }
            }

            // 5. ÁªòÂà∂Âè∏‰ª§ (The Commander)
            gCtx.save();
            gCtx.translate(ball.x, ball.y);
            gCtx.rotate(ball.rotation);
            // ÁªòÂà∂ÂúÜÂΩ¢Ë£ÅÂàáÁöÑÂ§ßÂ§¥ÁÖß
            gCtx.beginPath();
            gCtx.arc(0, 0, ball.r, 0, Math.PI * 2);
            gCtx.clip();
            if(commanderImg.complete && commanderImg.naturalWidth > 0) {
                gCtx.drawImage(commanderImg, -ball.r, -ball.r, ball.r*2, ball.r*2);
            } else {
                // Â¶ÇÊûúÂõæÁâáÊ≤°Âä†ËΩΩÂá∫Êù•ÔºåÁîª‰∏™ÈªÑËÑ∏Â§áÁî®
                gCtx.fillStyle = '#f1c40f';
                gCtx.fill();
                gCtx.fillStyle = '#000';
                gCtx.fillText('^_^', -10, 5);
            }
            gCtx.restore();

            // 6. ÁªòÂà∂ÂºπÂºìÂâçÈÉ® (Sling Front)
            gCtx.beginPath();
            gCtx.lineWidth = 6;
            gCtx.strokeStyle = '#5d4037';
            gCtx.moveTo(SLING_X + 10, SLING_Y);
            if(ball.state === 'dragging') {
                gCtx.lineTo(ball.x, ball.y + 10);
            } else {
                gCtx.lineTo(SLING_X, SLING_Y);
            }
            gCtx.stroke();

            // ÂºπÂºìÂ∫ïÂ∫ß
            gCtx.fillStyle = '#5d4037';
            gCtx.fillRect(SLING_X - 5, SLING_Y, 10, GROUND_Y - SLING_Y);

            requestAnimationFrame(updateGame);
        }

        function winLevel() {
            // Ëß£ÈîÅÁÖßÁâá
            const photo = document.getElementById(`lp${level}`);
            if(photo) {
                photo.classList.add('unlocked');
            }
            
            // Â∫ÜÁ•ùÊèêÁ§∫
            if(level < 3) {
                level++;
                showModal('VICTORY!', `Commander, target destroyed! Moving to mission ${level}.`);
                setTimeout(() => {
                    closeModal();
                    initLevel();
                }, 2000);
            } else {
                showModal('MISSION ACCOMPLISHED!', 'Commander, you have conquered the field!');
            }
        }

        initLevel();
        updateGame();

    </script>
</body>
</html>